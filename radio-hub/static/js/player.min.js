function _wndt_player(t,e,a){function i(){var t;return t=void 0!==window.ActiveXObject?new ActiveXObject("ShockwaveFlash.ShockwaveFlash"):navigator.plugins["Shockwave Flash"],!!t}function n(){var t=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!t&&parseInt(t[2],10)}function s(){let t=navigator.userAgent.toLowerCase();if("micromessenger"==t.match(/MicroMessenger/i))return!0}function l(t){return!(!t||-1==t.indexOf("http"))&&"https"==t.split(":")[0]}function o(t){let e=!1,a=0,i={data:()=>({icon:'<i class="fas fa-play"></i>',add_class:""}),methods:{play:function(){wnd_inner_html("#flash-player",""),wnd_inner_html("#hls-player",""),wnd_inner_html("#ali-player",""),t.paused?(t.play(),this.icon="",this.add_class="playing"):(t.pause(),this.icon="",this.add_class="")}},created:function(){t.ontimeupdate=(()=>{t.currentTime>1&&t.currentTime<=a+.5||e||(e=!0,this.icon="",this.add_class="playing")}),t.onloadstart=t.onloadeddata=t.onloadedmetadata=t.onwaiting=(()=>{e=!1,this.icon='<a class="button is-danger is-loading"></a>',this.add_class=""}),t.onpause=t.oncanplay=(()=>{e=!1,this.icon='<i class="fas fa-play"></i>',this.add_class=""}),t.onerror=(()=>{e=!1,this.icon='<i class="fas fa-exclamation-triangle"></i>',this.add_class=""})}};Vue.createApp(i).mount("#footer-app")}let r={template:'\n<div id="ajax-player">\n\t<div id="player-title" v-if="is_home">\n\t\t<h3 class="center-title is-hidden-mobile"><span class="h-span">Last FM</span></h3>\n\t\t<h1 class="title is-size-5">\n\t\t\t<span class="icon"><i class="fa fa-headphones-alt"></i></span>&nbsp;<a :href="station.link">{{station.title}}</a>\n\t\t</h1>\n\t</div>\n\t<div v-show="\'hls\'==player_type" id="hls-player"></div>\n\t<div v-show="\'ali\'==player_type" id="ali-player"></div>\n\t<div v-show="\'h5\'==player_type" id="h5-player"></div>\n\t<div v-show="\'flash\'==player_type" id="flash-player"></div>\n\t<div id="ajax-player-bar" class="has-text-centere content">\n\t\t\t<div class="tabs is-fullwidth is-hidden-desktop is-hidden-tablet" :class="\'h5\' != player_type ? \'is-hidden\' : \'\'">\n\t\t\t\t<ul><li><a></a></li><li class="is-active"><a></a></li><li><a></a></li></ul>\n\t\t\t</div>\n\t\t<div id="ajax-player-meta">\n\t\t\t<span class="icon"><i class="fas fa-comment-dots"></i></span><a class="smooth" :href="station.link + \'#comments\'">Comments</a>&nbsp;\n\t\t\t&nbsp;-&nbsp;<span class="icon"><i class="fas fa-satellite-dish"></i></span>\n\t\t\t<a v-for="(stream, index) in station.stream" :class="stream == current_stream ? \'is-active\' : \'\'" @click="build_player(stream, index)">{{stream.type}}</a>\n\t\t\t<span v-html="station.message"></span>\n\t\t</div>\n\t\t<div v-show="station_notice.content || site_notice.content" class="notification is-light" :class="station_notice.class || site_notice.class" v-html="station_notice.content || site_notice.content"></div>\n\t\t<div class="wndt-ads" v-show="is_home && !is_vip"></div>\n\t</div>\n</div>',data:()=>({station:{},player_type:"",current_stream:{},local_storage:[],local_storage_index:0,is_new_station:!0,is_home:a,is_vip:wndt.is_vip,station_notice:{class:"",content:""},site_notice:wndt.site_notice}),methods:{build_player:function(t,a){if(this.current_stream=t,this.station.default_stream_index=a,this.player_type=this.choose_player(t),"new_window"==this.player_type)return this.station_notice={class:"is-warning",content:`<p>当前播放受限，请在点击新窗口播放，或选择其他线路：</p><p><a class="button is-danger is-small is-outlined" href="http://player.tingfm.com/?id=${e}">新窗口播放</a></p>`},wnd_inner_html("#h5-player",""),wnd_inner_html("#hls-player",""),void this.save_to_local();this.station_notice={class:"",content:""};let n=parseFloat(localStorage.getItem("wndt_volume")?localStorage.getItem("wndt_volume"):"0.5");n=is_mobile?1:n;let s=!0,l=t.url,o=document.querySelector("#audio-player");o&&o.pause(),wnd_inner_html("#flash-player",""),wnd_inner_html("#hls-player",""),wnd_inner_html("#ali-player",""),"hls"==this.player_type?this.build_hls_player(l,n,s):"ali"==this.player_type?this.build_aliplayer(l,n,s):"flash"==this.player_type?(this.build_flash_player(l,n,s),i()||(this.station_notice={class:"is-warning",content:`<p>当前线路需<b>国产浏览器</b>并：<a href="https://www.flash.cn"><b>安装Flash</b></a>，或在：<a onclick="wnd_ajax_modal('wndt_qrcode_modal', {post_id : ${e}})"><b>手机收听</b></a></p>`})):this.build_h5_player(l,n,s),this.save_to_local(),this.show_ads()},show_ads:function(){a&&!wndt.is_vip&&wnd_inner_html(t+" .wndt-ads",'\n<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3030540414938051"\n     crossorigin="anonymous"></script>\n\t<!-- 自适应广告 -->\n\t<ins class="adsbygoogle"\n\t     style="display:block"\n\t     data-ad-client="ca-pub-3030540414938051"\n\t     data-ad-slot="2731914802"\n\t     data-ad-format="auto"\n\t     data-full-width-responsive="true"></ins>\n<script>\n     (adsbygoogle = window.adsbygoogle || []).push({});\n</script>')},check_adblock:function(){if(wndt.is_vip||wnd_is_spider())return!1;if("undefined"==typeof can_run_ads){let t=localStorage.getItem("adblocked");if(!t)return localStorage.setItem("adblocked",timestamp),!1;if(timestamp-t>3600)return!0}return!1},choose_player:function(t){if("unknown"==t.type)return"ali";let e=!("yes"!=(this.station.meta.m3u8_support_hls||!1)&&!this.station.meta.stream_ytid),a="https:"==location.protocol&&!l(t.url);if(is_mobile){let i=navigator.userAgent||"";if(i.match(/(Baiduboxapp|micromessenger|MQQBrowser)/i))return"h5";let s=i.match(/(iPhone|iPad)/i);return a&&(n()>=80||s)?"new_window":s?"h5":"m3u8"==t.type&&e&&"radio"==this.station.type?"hls":"h5"}return"m3u8"!=t.type?a&&n()>=80&&!s()?"new_window":"h5":e?a?"new_window":"hls":"flash"},build_hls_player:function(t,e,a=!1){function i(){ch_videoObject={container:"#hls-player",volume:e,autoplay:a,loop:!1,live:!0,loaded:"chLoadedHandler",html5m3u8:!0,video:t},ch_player=new chplayer(ch_videoObject)}if("undefined"==typeof chplayer){let t=static_url+"/chplayer/chplayer.min.js?ver="+wndt.ver;wnd_load_script(t,()=>{i()})}else i()},build_h5_player:function(t,e,a=!1){let i=a?"autoplay":"",n="";n="radio"==this.station.type?`<audio id="audio-player" class="h5-player-el is-hidden-mobile" src="${t}" controls ${i}/>`:`<video id="video-player" class="h5-player-el" src="${t}" controls ${i}/>`,"undefined"==typeof audio_player?(wnd_inner_html("#h5-player",n),audio_player=document.querySelector(".h5-player-el"),o(audio_player)):audio_player.src=t,is_mobile||(audio_player.volume=e,audio_player.onvolumechange=(()=>{localStorage.setItem("wndt_volume",audio_player.volume)}))},build_flash_player:function(t,e,a=!1){function i(){let i={container:"#flash-player",variable:"ck_player",loaded:"ckLoadedHandler",live:!0,volume:e,autoplay:a,video:t};loading_ps="bottom",ck_player=new ckplayer(i)}if("undefined"==typeof ckplayer){let t=static_url+"/ckplayer/ckplayer.min.js?ver="+wndt.ver;wnd_load_script(t,()=>{i()})}else i()},build_aliplayer:function(t,e,a=!1){function i(){new Aliplayer({id:"ali-player",source:t,width:"100%",height:"60px",autoplay:a,isLive:!0,rePlay:!1,playsinline:!0,preload:!0,controlBarVisibility:"always",useH5Prism:!0,skinLayout:[{name:"bigPlayButton",align:"blabs",x:"50%",y:0},{name:"H5Loading",align:"cc"},{name:"controlBar",align:"blabs",x:0,y:0,children:[{name:"liveDisplay",align:"tlabs",x:15,y:6},{name:"volume",align:"tr",x:5,y:10}]}]},function(t){t.setVolume(e),document.onkeydown=function(e){let a=window.event?e.keyCode:e.which;32==a&&("playing"==t.getStatus()?t.pause():t.play())}})}if("undefined"==typeof Aliplayer){wnd_load_style("https://g.alicdn.com/de/prismplayer/2.9.17/skins/default/aliplayer-min.css");let t="https://g.alicdn.com/de/prismplayer/2.9.17/aliplayer-min.js";wnd_load_script(t,()=>{i()})}else i()},get_remote_station:function(){"undefined"==typeof token&&(token=wndt.token);let t=axios({method:"GET",url:wnd_query_api+"/wndt_post",params:{post_id:e,in_web:!0},headers:{"Stream-Token":token}}).then(t=>t.data.status<=0?(this.station_notice={class:"is-warning",content:t.data.msg},!1):t.data.data).catch(function(t){console.log(t)});return t},get_local_station:async function(){let t;this.local_storage=localStorage.getItem("wndt_stations")?JSON.parse(localStorage.getItem("wndt_stations")):[];for(let a=0;a<this.local_storage.length;a++)if(this.local_storage[a].station.ID==e){if(t=this.local_storage[a],t.station.meta.stream_ytid){let e=await this.get_remote_station();e&&(t.station=Object.assign(t.station,e))}this.is_new_station=!1,this.local_storage_index=a;break}return!this.is_new_station&&(!(wndt.modified>t.time||wndt.force_refresh>t.time)&&t.station)},save_to_local:function(){if(this.is_new_station){let t={station:this.station,time:timestamp};this.local_storage.unshift(t)}else{let t=this.local_storage_index;this.local_storage[t].station=this.station,this.local_storage[t].time=timestamp}this.local_storage.length>wndt.local_storage_limit&&(this.local_storage.length=wndt.local_storage_limit),localStorage.setItem("wndt_stations",JSON.stringify(this.local_storage))}},created:function(){},mounted:async function(){if(this.check_adblock())return wnd_inner_html(t,wndt.fuck_adblock),!1;let e=await this.get_local_station(),a=!1;if(a=e||await this.get_remote_station(),!a)return!1;a=Object.assign(this.station,a),this.station=a;let i=this.station.default_stream_index||0;this.build_player(this.station.stream[i],i),localStorage.setItem("wndt_last",JSON.stringify(this.station))}},d=document.querySelector(t);wnd_inner_html(d,'<div class="vue-app"></div>'),Vue.createApp(r).mount(t+" .vue-app")}function ckLoadedHandler(){ck_player.addListener("volume",ckVolumeChangeHandler),ck_player.addListener("error",ckErrorHandler)}function ckVolumeChangeHandler(t){localStorage.setItem("wndt_volume",t)}function ckErrorHandler(){console.log("播放错误")}function chLoadedHandler(){ch_player.addListener("volumechange",chVolumeChangeHandler),ch_player.addListener("error",chErrorHandler),ch_player.addListener("loadedmetadata",chloadedMetaHandler)}function chVolumeChangeHandler(){localStorage.setItem("wndt_volume",ch_player.volume)}function chErrorHandler(){console.log("播放错误")}function chloadedMetaHandler(){let t=ch_player.vars,e=ch_player.getMetaDate();!0===t.autoplay&&e.paused&&(t.autoplay=!1,ch_player.newVideo(t),ch_player.loadingStart(!1))}